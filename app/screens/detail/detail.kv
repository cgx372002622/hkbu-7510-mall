#:import Window kivy.core.window.Window

<Detail>:
    detail_id: 'goods-1'
    picUrl: ''
    detail_name: ''
    price: ''
    store: ''
    description: ''
    comments: None

    MDBoxLayout:
        size_hint: (1, 1)
        orientation: 'vertical'

        MDScrollView:

            GridLayout:
                cols: 1
                size_hint: ((1, None))
                height: self.minimum_height
                spacing: dp((Window.height/1080)*20)

                AsyncImage:
                    source: root.picUrl
                    size_hint: ((1, None))
                    height: Window.height / 2
                    allow_stretch: True
                    nocache: False

                MDBoxLayout:
                    md_bg_color: app.primary_bg_color
                    size_hint: ((1, None))
                    height: self.minimum_height
                    orientation: 'vertical'
                    spacing: dp((Window.height/1080)*20)
                    padding: app.padding_md

                    MDLabel:
                        text: '$ ' + root.price
                        size_hint: ((1, None))
                        color: app.price_text_color
                        font_size: app.font_size_lg
                        height: self.texture_size[1]

                    MDLabel:
                        text: root.detail_name
                        size_hint: (1, None)
                        color: app.primary_font_color
                        font_size: app.font_size
                        height: self.texture_size[1]

                    MDLabel:
                        text: root.store
                        size_hint: (1, None)
                        color: app.quaternary_text_color
                        font_size: app.font_size_sm
                        height: self.texture_size[1]

                    MDLabel:
                        text: root.description
                        size_hint: (1, None)
                        color: app.tertiary_text_color
                        font_size: app.font_size_sm
                        height: self.texture_size[1]

                MDBoxLayout:
                    md_bg_color: app.primary_bg_color
                    size_hint: (1, None)
                    height: self.minimum_height
                    orientation: 'vertical'
                    spacing: dp((Window.height/1080)*30)
                    padding: app.padding_md

                    MDLabel:
                        text: 'Comment'
                        size_hint: (1, None)
                        color: app.primary_font_color
                        font_size: app.font_size_lg
                        height: app.font_size_lg

                    MDBoxLayout:
                        size_hint: (1, None)
                        height: self.minimum_height
                        orientation: 'horizontal'

                        MDTextField:
                            id: comment
                            hint_text: "Add your comment"
                            mode: "rectangle"
                            size_hint: 0.7, None
                            font_size: app.font_size_sm
                            on_focus: root.comment_on_focus(self, self.focus)

                        MDIconButton:
                            icon: "pencil"
                            pos_hint: {"center_x": .5, "center_y": .5}
                            size_hint: 0.2, None
                            type: 'small'
                            on_release: root.make_a_comment()

                    MDBoxLayout:
                        spacing: dp((Window.height/1080)*20)
                        size_hint: (1, None)
                        orientation: 'vertical'
                        id: comment_box
                        height: self.minimum_height

        MDStackLayout:
            size_hint: ((1, None))
            md_bg_color: app.navigator_bg_color
            spacing: app.padding_xs
            padding: app.padding_xs
            orientation: 'rl-bt'
            height: self.minimum_height

            MDFillRoundFlatIconButton:
                text: 'ADD'
                icon: 'cart'
                md_bg_color: app.primary_btn_bg_color
                theme_icon_color: 'Custom'
                icon_color: app.primary_font_color
                theme_text_color: 'Custom'
                text_color: app.primary_font_color
                on_press: root.add_in_cart()
                size_hint: None, .8

    MDBoxLayout:
        adaptive_size: True
        pos_hint: {"center_x": .1, "center_y": 0.95}

        MDFloatingActionButton:
            icon: 'arrow-left'
            md_bg_color: app.primary_bg_color
            icon_color: app.primary_font_color
            on_press: root.go_back()

<Comment>
    content: None
    time: None
    username: None
    size_hint: (1, None)
    orientation: 'vertical'
    height: box1.height + box2.height
    spacing: app.padding_xs

    MDBoxLayout:
        id: box1
        size_hint: (1, None)
        height: content.height

        MDLabel:
            id: content
            text: root.content if root.content else ''
            size_hint: (1, None)
            color: app.primary_font_color
            font_size: app.font_size
            height: self.texture_size[1]
    
    MDBoxLayout:
        id: box2
        size_hint: (1, None)
        height: time.height
        orientation: 'horizontal'

        MDLabel:
            size_hint_x: 0.4
        MDLabel:
            id: time
            text: root.time if root.time else ''
            size_hint_x: 0.3
            color: app.tertiary_text_color
            font_size: app.font_size_sm
            height: self.texture_size[1]
        MDLabel:
            size_hint_x: 0.01
        MDLabel:
            id: username
            text: root.username if root.username else ''
            size_hint_x: 0.2
            color: app.tertiary_text_color
            font_size: app.font_size_sm
            height: self.texture_size[1]